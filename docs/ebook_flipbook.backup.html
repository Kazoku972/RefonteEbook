<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>On est ensemble, Maman - Version Flipbook</title>
    <!-- On utilise turn.js via CDN pour la dÃ©mo, mais on privilÃ©gie l'offline-first en prod -->
    <script src="js/jquery.min.js"></script>
    <script src="js/turn.min.js"></script>
    <link rel="stylesheet" href="ebook_interactif.css">
    <style>
        html, body { overscroll-behavior: none !important; }
        /* âœ… QA: AGRANDISSEMENT IMAGES PAGES 2,4,6,7 */
        /* Targets: page 2/4/6/7 images only via Turn.js stable classes */
        #flipbook .p2 .page-content img,
        #flipbook .p4 .page-content img,
        #flipbook .p6 .page-content img,
        #flipbook .p7 .page-content img {
            max-height: 430px !important;
            margin: 0.6rem auto !important;
        }

        @media (max-width: 650px) {
            #flipbook .p2 .page-content img,
            #flipbook .p4 .page-content img,
            #flipbook .p6 .page-content img,
            #flipbook .p7 .page-content img {
                max-height: 310px !important;
            }
        }

        /* âœ… CENTRAGE PAGES 3 & 5 (CITATIONS / RAPPELS) */
        #flipbook .p3 .page-content,
        #flipbook .p5 .page-content {
            display: flex !important;
            flex-direction: column !important;
            justify-content: center !important;
            align-items: center !important;
            text-align: center !important;
            height: 100% !important;
        }

        /* âœ… iOS BUG FIX: EDGE GUARDS (Prevents "Back" gesture) */
        #edge-guard-left, #edge-guard-right {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 22px;
            z-index: 1000;
            background: transparent;
            pointer-events: auto;
            touch-action: pan-y;
        }
        #edge-guard-left { left: 0; }
        #edge-guard-right { right: 0; }

        /* âœ… DIDACTICIEL SWIPE V4 (MOBILE PUBLIC) */
        #swipe-hint {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 100px;
            height: 100px;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            background: url("./assets/swipe-left.png") no-repeat center;
            background-size: contain;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
        }
        #swipe-hint.active {
            animation: swipeGlideDouble 2.6s ease-in-out forwards;
        }

        @keyframes swipeGlideDouble {
            0% { transform: translateX(50px); opacity: 0; }
            10% { opacity: 1; }
            45% { transform: translateX(-120px); opacity: 0; }
            55% { transform: translateX(50px); opacity: 0; }
            65% { opacity: 1; }
            100% { transform: translateX(-120px); opacity: 0; }
        }

        /* âœ… PERSISTENCE LANDSCAPE FIX */
        @media (orientation: landscape) {
            #flipbook .page-content img {
                max-height: 32vh !important;
                max-width: 90% !important;
                width: auto !important;
                height: auto !important;
                object-fit: contain !important;
                margin: 5px auto !important;
            }
            .page-content {
                padding-top: 10px !important;
                padding-bottom: 10px !important;
                justify-content: flex-start !important;
            }
            h2 {
                font-size: 1.2rem !important;
                margin-top: 0.5rem !important;
                margin-bottom: 0.5rem !important;
            }
            p {
                font-size: 0.9rem !important;
                line-height: 1.3 !important;
                margin-bottom: 1vh !important;
            }
        }
    </style>
</head>
<body style="background: #f0f0f0;">

<!-- SWIPE HINT overlay (non bloquant, visible au chargement) -->
<div id="swipe-hint" aria-hidden="true"></div>

<!-- âœ… iOS BUG FIX: EDGE GUARDS -->
<div id="edge-guard-left"></div>
<div id="edge-guard-right"></div>

<div id="flipbook-viewport">
    <div id="flipbook">
        
        <!-- COUVERTURE -->
        <div class="flip-page hard">
            <div class="page-content" style="background-color: var(--color-sable);">
                <img src="images/couverture.png" alt="Couverture" class="hero-img" style="max-height: 480px;">
                <h1>On est ensemble, Maman</h1>
                <p style="font-style: italic; color: var(--color-sauge);">Douceur et LumiÃ¨re au Quotidien</p>
            </div>
        </div>

        <!-- PAGE 2: AVANT-PROPOS -->
        <div class="flip-page">
            <div class="page-content">
                <h2>Avant-propos</h2>
                <img src="images/ScÃ¨ne RÃ©veil Matin Chaotique.png" alt="Matin">
                <p>Imagine une lumiÃ¨re matinale, douce et dorÃ©e... lâ€™odeur du cafÃ© qui infuse... et cette sensation que tout va un peu trop vite.</p>
                <p>Moi, c'est <strong>Marine</strong>. Je vis ce "chaos joyeux" chaque jour avec <strong>KaÃ¯to</strong> (4 ans) et <strong>Yuna</strong> (2 ans).</p>
            </div>
        </div>

        <!-- PAGE 3: CITATION -->
        <div class="flip-page">
            <div class="page-content" style="justify-content: center;">
                <div class="quote">"Tu n'es pas seule. Et tu n'as pas Ã  porter ce poids toute seule."</div>
                <p style="text-align: center; color: var(--color-sauge);">â€” On est ensemble, Maman</p>
            </div>
        </div>

        <!-- PAGE 4: CHAPITRE 1 -->
        <div class="flip-page">
            <div class="page-content">
                <h2>1. Le Miroir de la GuerriÃ¨re</h2>
                <p>Devenir maman, c'est voir un paysage transformÃ© par un tsunami. Porter la vie est une force de guerriÃ¨re cachÃ©e sous une peau fatiguÃ©e.</p>
                <img src="images/Illustration 1.1 - La remise en perspective (La guerriÃ¨re).png" alt="GuerriÃ¨re">
                <p style="font-style: italic; font-size: 0.9rem;">"ÃŠtre vulnÃ©rable aujourd'hui, ce n'est pas Ãªtre faible. C'est Ãªtre vivante."</p>
            </div>
        </div>

        <!-- PAGE 5: RAPPEL -->
        <div class="flip-page">
            <div class="page-content" style="justify-content: center;">
                <div class="alert-box">
                    <strong>Ã€ retenir</strong>
                    Ta fatigue est le tÃ©moin de tout l'amour que tu diffuses. Elle mÃ©rite d'Ãªtre honorÃ©e, pas jugÃ©e.
                </div>
            </div>
        </div>

        <!-- PAGE 6: EXERCICE -->
        <div class="flip-page">
            <div class="page-content">
                <h2 style="font-size: 1.5rem;">ðŸŒŸ L'Ã‰quilibre dans le Chaos</h2>
                <p>La vraie vie a des couleurs vibrantes : le bleu de la peinture, le rose des joues, le beige du dÃ©sordre.</p>
                <img src="images/Illustration 6.1 - Le miroir bienveillant (Auto-affirmation).png" alt="Miroir">
                <div style="font-style: italic; margin-top: 10px; font-size: 0.9rem;"><strong>Pacte de LumiÃ¨re :</strong> "Je m'autorise Ã  Ãªtre une femme imparfaite et une maman aimante."</div>
            </div>
        </div>

        <!-- PAGE 7: CONCLUSION -->
        <div class="flip-page">
            <div class="page-content" style="text-align: center; justify-content: center;">
                <img src="images/ScÃ¨ne Coucher Tendre.png" alt="Coucher">
                <h2 style="font-size: 1.2rem;">On est ensemble</h2>
                <p style="font-size: 0.85rem;">Ce guide est une petite lampe de chevet pour tes nuits trop courtes. Tu n'as pas Ã  briller seule.</p>
                <p style="font-family: cursive; color: var(--color-rose); font-size: 1.3rem; margin-top: 0.5rem;">Marine ðŸ’•</p>
            </div>
        </div>

    </div>
</div>


<script>
    $(window).ready(function() {
        var flipbook = $('#flipbook');

        // Initialisation Turn.js optimisÃ©e pour le swipe mobile
        flipbook.turn({
            display: 'single',
            width: window.innerWidth,
            height: window.innerHeight,
            autoCenter: true,
            gradients: true,
            acceleration: true,
            elevation: 50,
            duration: 1000,
            when: {
                turned: function(e, page) {
                    console.log('Page actuelle :', page);
                }
            }
        });

        // Logiciel de Swipe Hint (joue 2 cycles au chargement)
        // et iOS BUG FIX: EDGE GUARDS (Prevents "Back" gesture)
        setTimeout(function() {
            showSwipeHint();

            const preventBack = (e) => {
                if (e.cancelable) e.preventDefault();
            };
            const egl = document.getElementById('edge-guard-left');
            const egr = document.getElementById('edge-guard-right');
            // Use non-passive listeners to allow preventDefault
            if (egl) egl.addEventListener('touchmove', preventBack, {passive: false});
            if (egr) egr.addEventListener('touchmove', preventBack, {passive: false});
        }, 1000);

        // Gestion du redimensionnement dynamique
        $(window).resize(function() {
            flipbook.turn('size', window.innerWidth, window.innerHeight);
        });

        // Navigation clavier (confort desktop)
        $(window).bind('keydown', function(e) {
            if (e.keyCode === 37) {
                flipbook.turn('previous');
            } else if (e.keyCode === 39) {
                flipbook.turn('next');
            }
        });
        // Logiciel de Swipe Hint (joue 2 cycles au chargement)
        function showSwipeHint() {
            var hint = $('#swipe-hint');
            if (hint.length) {
                setTimeout(function() {
                    hint.addClass('active');
                    // Retrait auto du DOM aprÃ¨s les 2 cycles (2.6s)
                    setTimeout(function() {
                        hint.remove();
                    }, 3000);
                }, 1000); // Petit dÃ©lai pour laisser la page charger
            }
        }
        showSwipeHint();
    });
</script>

</body>
</html>
